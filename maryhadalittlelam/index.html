<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>å¤–è³£åˆ†è³¬è¨ˆæ•¸å™¨ | æ¯›æ¯›å°ˆç”¨</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- ç”Ÿæˆå›¾ç‰‡ä¾èµ– -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+HK:wght@300;400;500;600&display=swap');
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Noto Sans HK', å¾®è»Ÿæ­£é»‘é«”, sans-serif;
        }
        body {
            background: #fdfbf8;
            padding: 15px;
            max-width: 750px;
            margin: 0 auto;
            min-height: 100vh;
        }
        .container {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 8px 24px rgba(206, 183, 163, 0.15);
            padding: 25px;
            border: 1px solid #f0e9e2;
        }
        .header {
            text-align: center;
            margin-bottom: 25px;
        }
        .header h1 {
            color: #8c6d53;
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .header p {
            color: #b8a390;
            font-size: 13px;
        }
        /* æ¨¡å¼åˆ‡æ› */
        .mode-tab {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-radius: 12px;
            background: #faf7f4;
            padding: 5px;
        }
        .tab-item {
            flex: 1;
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            color: #b8a390;
            cursor: pointer;
            transition: all 0.2s;
        }
        .tab-item.active {
            background: #8c6d53;
            color: #fff;
        }
        .mode-content {
            display: none;
        }
        .mode-content.active {
            display: block;
        }
        .input-card {
            background: #faf7f4;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group:last-child {
            margin-bottom: 0;
        }
        label {
            display: block;
            color: #8c6d53;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
        }
        input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #e8dcd0;
            border-radius: 10px;
            font-size: 15px;
            outline: none;
            background: #fff;
            transition: all 0.2s;
        }
        input:focus {
            border-color: #d4bfa7;
            box-shadow: 0 0 0 3px rgba(212, 191, 167, 0.1);
        }
        input::placeholder {
            color: #d9c9bc;
        }
        .btn {
            width: 100%;
            padding: 13px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-primary {
            background: #d4bfa7;
            color: #fff;
        }
        .btn-primary:hover {
            background: #c7ae97;
        }
        .btn-calc {
            background: #8c6d53;
            color: #fff;
            margin-top: 10px;
        }
        .btn-calc:hover {
            background: #7a5d46;
        }
        .btn-img {
            background: #c77866;
            color: #fff;
            margin-top: 10px;
        }
        .btn-img:hover {
            background: #b96856;
        }
        .list-card {
            margin-bottom: 20px;
        }
        .card-title {
            color: #8c6d53;
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .card-title::before {
            content: '';
            display: block;
            width: 4px;
            height: 16px;
            background: #d4bfa7;
            border-radius: 2px;
        }
        .empty-tip {
            text-align: center;
            padding: 30px 0;
            color: #b8a390;
            font-size: 14px;
        }
        .item-list {
            display: grid;
            gap: 10px;
        }
        .item-card {
            background: #faf7f4;
            border-radius: 12px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #f0e9e2;
        }
        .item-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .item-person {
            color: #5c4838;
            font-weight: 500;
            font-size: 15px;
        }
        .item-price {
            color: #c77866;
            font-size: 13px;
        }
        .del-btn {
            background: #f8ece8;
            color: #c77866;
            border: none;
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
        }
        .del-btn:hover {
            background: #f1e0db;
        }
        .result-card {
            background: #faf7f4;
            border-radius: 16px;
            padding: 20px;
            display: none;
            margin-bottom: 20px;
        }
        .total-summary {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px dashed #e8dcd0;
            font-size: 14px;
        }
        .total-summary:last-child {
            border-bottom: none;
        }
        .summary-label {
            color: #8c6d53;
        }
        .summary-value {
            color: #5c4838;
            font-weight: 600;
        }
        .summary-red {
            color: #c77866;
        }
        .person-result-list {
            margin-top: 20px;
            display: grid;
            gap: 12px;
        }
        .person-card {
            background: #fff;
            border-radius: 12px;
            padding: 18px;
            border: 1px solid #f0e9e2;
        }
        .person-name {
            color: #8c6d53;
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #f0e9e2;
        }
        .person-detail {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-bottom: 8px;
        }
        .person-detail:last-child {
            margin-bottom: 0;
        }
        .detail-label {
            color: #b8a390;
        }
        .detail-value {
            color: #5c4838;
            font-weight: 500;
        }
        .detail-pay {
            color: #c77866;
            font-weight: 600;
            font-size: 15px;
        }
        .tip-box {
            padding: 12px 15px;
            background: #f8ece8;
            border-radius: 10px;
            font-size: 12px;
            color: #c77866;
            border: 1px solid #f1e0db;
            margin-top: 10px;
        }
        /* è‡ªå·±å€‹é¤çµæœ */
        .simple-result {
            background: #fff;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #f0e9e2;
            text-align: center;
        }
        .simple-result h3 {
            color: #8c6d53;
            font-size: 16px;
            margin-bottom: 20px;
        }
        .simple-detail {
            display: flex;
            justify-content: space-between;
            font-size: 15px;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #faf7f4;
        }
        .simple-detail:last-child {
            border-bottom: none;
            margin-bottom: 20px;
        }
        .simple-pay {
            font-size: 18px;
            font-weight: 600;
            color: #c77866;
        }
        /* ç”Ÿæˆå›¾ç‰‡å®¹å™¨ */
        #imgResult {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        #imgResult img {
            max-width: 100%;
            border-radius: 12px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>å¤–è³£åˆ†è³¬è¨ˆæ•¸å™¨</h1>
            <p>è¨ˆæ›¬å…¨éƒ¨é¤ | è‡ªå·±å¿«é€Ÿè¨ˆè‡ªä»˜</p>
        </div>

        <!-- æ¨¡å¼åˆ‡æ›æ¨™ç±¤ -->
        <div class="mode-tab">
            <div class="tab-item active" data-mode="admin">å…¨é¤ç¸½å’Œ</div>
            <div class="tab-item" data-mode="user">è‡ªå·±å€‹é¤</div>
        </div>

        <!-- å…¨é¤ç¸½å’Œå…§å®¹ -->
        <div class="mode-content active" id="adminMode">
            <!-- æ–°å¢é¤å“ -->
            <div class="input-card">
                <div class="input-group">
                    <label>é»é¤äºº</label>
                    <input type="text" id="adminPersonName" placeholder="ä¾‹å¦‚ï¼šAlbertã€Mary" required>
                </div>
                <div class="input-group">
                    <label>é¤å“é‡‘é¡ (HK$)</label>
                    <input type="number" id="adminItemPrice" step="0.01" min="0" placeholder="ä¾‹å¦‚ï¼š62.3" required>
                </div>
                <button class="btn btn-primary" id="adminAddItem">æ–°å¢é¤å“</button>
            </div>

            <!-- é¤å“åˆ—è¡¨ -->
            <div class="list-card">
                <div class="card-title">å·²æ·»åŠ é¤å“</div>
                <div class="item-list" id="adminItemList">
                    <div class="empty-tip">æš«ç„¡é¤å“ï¼Œè«‹é»ä¸Šæ–¹æ–°å¢</div>
                </div>
            </div>

            <!-- å„ªæƒ /é‹è²»è¨­ç½® -->
            <div class="input-card">
                <div class="input-group">
                    <label>å„ªæƒ åˆ¸æŠµæ‰£ (HK$)</label>
                    <input type="number" id="adminCoupon" step="0.01" min="0" value="0" placeholder="ç„¡å„ªæƒ å¡«0">
                </div>
                <div class="input-group">
                    <label>æ•´å–®æŠ˜æ‰£ (%) - 9æŠ˜å¡«10</label>
                    <input type="number" id="adminDiscount" step="0.01" min="0" max="100" value="0" placeholder="9æŠ˜å¡«10ï¼Œç„¡æŠ˜æ‰£å¡«0">
                </div>
                <div class="input-group">
                    <label>é‹è²» (HK$)</label>
                    <input type="number" id="adminDelivery" step="0.01" min="0" value="0" placeholder="ç„¡é‹è²»å¡«0ï¼Œå…¨é«”åˆ†æ”¤">
                </div>
                <button class="btn btn-calc" id="adminCalc">è¨ˆç®—æ‰€æœ‰äººå¯¦æ•¸</button>
            </div>

            <!-- å…¨é¤ç¸½å’Œçµæœ -->
            <div class="result-card" id="adminResultCard">
                <div class="card-title">æ•´å–®åŒ¯ç¸½</div>
                <div class="total-summary">
                    <span class="summary-label">é¤å“ç¸½é‡‘é¡ï¼š</span>
                    <span class="summary-value" id="adminTotalFood">HK$ 0.00</span>
                </div>
                <div class="total-summary">
                    <span class="summary-label">é‹è²»ï¼š</span>
                    <span class="summary-value" id="adminTotalDelivery">HK$ 0.00</span>
                </div>
                <div class="total-summary">
                    <span class="summary-label">æŠ˜æ‰£æŠµæ‰£ï¼š</span>
                    <span class="summary-value summary-red" id="adminTotalDiscount">HK$ 0.00</span>
                </div>
                <div class="total-summary">
                    <span class="summary-label">å„ªæƒ åˆ¸æŠµæ‰£ï¼š</span>
                    <span class="summary-value summary-red" id="adminTotalCoupon">HK$ 0.00</span>
                </div>
                <div class="total-summary" style="font-size:16px;margin-top:8px;">
                    <span class="summary-label">æ•´å–®å¯¦ä»˜ç¸½é¡ï¼š</span>
                    <span class="summary-value summary-red" id="adminTotalRealPay">HK$ 0.00</span>
                </div>

                <div class="person-result-list" id="adminPersonResultList"></div>
                <button class="btn btn-img" id="generateImg">ç”Ÿæˆåˆ†äº«åœ–ï¼ˆsendå‡ºgpï¼‰</button>
                <div class="tip-box">
                    ğŸ’¡ è¨ˆç®—è¦å‰‡ï¼šå…ˆç®—é¤å“æŠ˜æ‰£â†’æ¸›å„ªæƒ åˆ¸â†’å¹³å‡åˆ†æ”¤é‹è²»ï¼›åŒä¸€äººå¤šä»½é¤å“è‡ªå‹•åˆè¨ˆ
                </div>
            </div>
        </div>

        <!-- è‡ªå·±å€‹é¤å…§å®¹ -->
        <div class="mode-content" id="userMode">
            <div class="input-card">
                <div class="input-group">
                    <label>è‡ªå·±å˜…é¤é‡‘é¡ (HK$)</label>
                    <input type="number" id="userMyPrice" step="0.01" min="0" placeholder="ä¾‹å¦‚ï¼š72.7" required>
                </div>
                <div class="input-group">
                    <label>æ•´å–®ç¸½åŸåƒ¹ (HK$)</label>
                    <input type="number" id="userTotalFood" step="0.01" min="0" placeholder="å¿…å¡«ï¼" required>
                </div>
                <div class="input-group">
                    <label>ç¸½åƒèˆ‡äººæ•¸</label>
                    <input type="number" id="userTotalPeople" step="1" min="1" value="2" placeholder="ä¾‹å¦‚ï¼š5">
                </div>
                <div class="input-group">
                    <label>æ•´å–®å„ªæƒ åˆ¸æŠµæ‰£ (HK$)</label>
                    <input type="number" id="userCoupon" step="0.01" min="0" value="0" placeholder="å„ªæƒ é‡‘é¡">
                </div>
                <div class="input-group">
                    <label>æ•´å–®æŠ˜æ‰£ (%) - 9æŠ˜å¡«10</label>
                    <input type="number" id="userDiscount" step="0.01" min="0" max="100" value="0" placeholder="9æŠ˜å¡«10">
                </div>
                <div class="input-group">
                    <label>æ•´å–®é‹è²» (HK$)</label>
                    <input type="number" id="userDelivery" step="0.01" min="0" value="0" placeholder="é‹è²»">
                </div>
                <button class="btn btn-calc" id="userCalc">è¨ˆç®—è‡ªå·±å¯¦æ•¸</button>
            </div>

            <!-- è‡ªå·±å€‹é¤çµæœ -->
            <div class="result-card" id="userResultCard">
                <div class="simple-result">
                    <h3>ä½ å˜…å¤–è³£å¯¦ä»˜è¨ˆç®—çµæœ</h3>
                    <div class="simple-detail">
                        <span class="detail-label">ä½ å˜…é¤å“åŸåƒ¹ï¼š</span>
                        <span class="detail-value" id="userMyOriginal">HK$ 0.00</span>
                    </div>
                    <div class="simple-detail">
                        <span class="detail-label">å€‹äººæŠ˜æ‰£æŠµæ‰£ï¼š</span>
                        <span class="detail-value" id="userMyDiscount">HK$ 0.00</span>
                    </div>
                    <div class="simple-detail">
                        <span class="detail-label">å€‹äººå„ªæƒ æŠµæ‰£ï¼š</span>
                        <span class="detail-value" id="userMyCoupon">HK$ 0.00</span>
                    </div>
                    <div class="simple-detail">
                        <span class="detail-label">åˆ†æ”¤é‹è²»ï¼š</span>
                        <span class="detail-value" id="userMyDelivery">HK$ 0.00</span>
                    </div>
                    <div class="simple-pay" id="userMyFinalPay">HK$ 0.00</div>
                </div>
                <div class="tip-box">
                    ğŸ’¡ è¨ˆç®—è¦å‰‡ï¼šæŒ‰ä½ é¤åƒ¹ä½”äººå‡åŸåƒ¹æ¯”ä¾‹åˆ†æ”¤å„ªæƒ /æŠ˜æ‰£ï¼Œé‹è²»å¹³å‡åˆ†æ”¤
                </div>
            </div>
        </div>

        <!-- ç”Ÿæˆå˜…åˆ†äº«åœ–å±•ç¤º -->
        <div id="imgResult">
            <img id="shareImg" src="" alt="å¤–è³£åˆ†è³¬åˆ†äº«åœ–">
            <p style="color:#8c6d53;font-size:13px;">é•·æŒ‰ä¿å­˜</p>
        </div>
    </div>

    <script>
        $(function() {
            // å…¨å±€è®Šé‡ï¼šå…¨é¤ç¸½å’Œé¤å“æ•¸æ“š
            let adminOrderList = [];

            // 1. æ¨¡å¼åˆ‡æ›é‚è¼¯
            $('.tab-item').click(function() {
                const mode = $(this).data('mode');
                // åˆ‡æ›æ¨™ç±¤æ¿€æ´»ç‹€æ…‹
                $('.tab-item').removeClass('active');
                $(this).addClass('active');
                // åˆ‡æ›å…§å®¹æ¿€æ´»ç‹€æ…‹
                $('.mode-content').removeClass('active');
                $(`#${mode}Mode`).addClass('active');
                // éš±è—ç”Ÿæˆå˜…åœ–ç‰‡
                $('#imgResult').hide();
            });

            // ====================== å…¨é¤ç¸½å’Œé‚è¼¯ ======================
            // æ¸²æŸ“ç¸½å‹™é¤å“åˆ—è¡¨
            function renderAdminItemList() {
                if (adminOrderList.length === 0) {
                    $('#adminItemList').html('<div class="empty-tip">æš«ç„¡é¤å“ï¼Œè«‹é»ä¸Šæ–¹æ–°å¢</div>');
                    return;
                }
                $('#adminItemList').empty();
                adminOrderList.forEach((item, index) => {
                    const itemHtml = `
                        <div class="item-card">
                            <div class="item-info">
                                <span class="item-person">${item.name}</span>
                                <span class="item-price">HK$ ${item.price.toFixed(2)}</span>
                            </div>
                            <button class="del-btn" data-index="${index}">åˆªé™¤</button>
                        </div>
                    `;
                    $('#adminItemList').append(itemHtml);
                });
            }

            // ç¸½å‹™æ–°å¢é¤å“
            $('#adminAddItem').click(function() {
                const name = $('#adminPersonName').val().trim();
                const price = parseFloat($('#adminItemPrice').val());
                if (!name || isNaN(price) || price < 0) {
                    alert('è«‹å¡«å¯«æ­£ç¢ºå˜…å§“åå’Œé‡‘é¡ï¼');
                    return;
                }
                adminOrderList.push({name, price});
                renderAdminItemList();
                $('#adminPersonName').val('');
                $('#adminItemPrice').val('');
                $('html, body').animate({scrollTop: $('#adminItemList').offset().top}, 300);
            });

            // ç¸½å‹™åˆªé™¤é¤å“
            $(document).on('click', '.del-btn', function() {
                const index = $(this).data('index');
                adminOrderList.splice(index, 1);
                renderAdminItemList();
            });

            // ç¸½å‹™è¨ˆç®—æ‰€æœ‰äººå¯¦ä»˜
            $('#adminCalc').click(function() {
                if (adminOrderList.length === 0) {
                    alert('è«‹å…ˆæ–°å¢é¤å“ï¼');
                    return;
                }
                const coupon = parseFloat($('#adminCoupon').val()) || 0;
                const discount = parseFloat($('#adminDiscount').val()) || 0;
                const delivery = parseFloat($('#adminDelivery').val()) || 0;

                // æŒ‰äººåˆ†çµ„è¨ˆç®—åŸåƒ¹
                const personTotal = {};
                let totalFoodPrice = 0;
                adminOrderList.forEach(item => {
                    personTotal[item.name] = (personTotal[item.name] || 0) + item.price;
                    totalFoodPrice += item.price;
                });
                const personList = Object.keys(personTotal);
                const personNum = personList.length;

                // è¨ˆç®—å„é …æŠµæ‰£
                const totalDiscountAmt = totalFoodPrice * (discount / 100);
                const foodAfterDiscount = totalFoodPrice - totalDiscountAmt;
                const foodAfterCoupon = Math.max(foodAfterDiscount - coupon, 0);
                const deliveryPerPerson = delivery / personNum;
                const totalRealPay = foodAfterCoupon + delivery;

                // è¨ˆç®—æ¯å€‹äººå¯¦ä»˜
                const personResult = [];
                personList.forEach(name => {
                    const original = personTotal[name];
                    const ratio = original / totalFoodPrice;
                    const personDiscount = ratio * totalDiscountAmt;
                    const personCoupon = Math.min(ratio * coupon, original - personDiscount);
                    const personFoodReal = Math.max(original - personDiscount - personCoupon, 0);
                    const personFinalPay = personFoodReal + deliveryPerPerson;
                    personResult.push({
                        name,
                        original: original.toFixed(2),
                        discount: personDiscount.toFixed(2),
                        coupon: personCoupon.toFixed(2),
                        foodReal: personFoodReal.toFixed(2),
                        delivery: deliveryPerPerson.toFixed(2),
                        finalPay: personFinalPay.toFixed(2)
                    });
                });

                // æ¸²æŸ“æ•´å–®åŒ¯ç¸½
                $('#adminTotalFood').text(`HK$ ${totalFoodPrice.toFixed(2)}`);
                $('#adminTotalDelivery').text(`HK$ ${delivery.toFixed(2)}`);
                $('#adminTotalDiscount').text(`HK$ ${totalDiscountAmt.toFixed(2)}`);
                $('#adminTotalCoupon').text(`HK$ ${coupon.toFixed(2)}`);
                $('#adminTotalRealPay').text(`HK$ ${totalRealPay.toFixed(2)}`);

                // æ¸²æŸ“æ¯äººçµæœ
                $('#adminPersonResultList').empty();
                personResult.forEach(p => {
                    const personHtml = `
                        <div class="person-card">
                            <div class="person-name">${p.name}</div>
                            <div class="person-detail">
                                <span class="detail-label">é¤å“åŸåƒ¹ï¼š</span>
                                <span class="detail-value">HK$ ${p.original}</span>
                            </div>
                            <div class="person-detail">
                                <span class="detail-label">æŠ˜æ‰£æŠµæ‰£ï¼š</span>
                                <span class="detail-value">HK$ ${p.discount}</span>
                            </div>
                            <div class="person-detail">
                                <span class="detail-label">å„ªæƒ æŠµæ‰£ï¼š</span>
                                <span class="detail-value">HK$ ${p.coupon}</span>
                            </div>
                            <div class="person-detail">
                                <span class="detail-label">åˆ†æ”¤é‹è²»ï¼š</span>
                                <span class="detail-value">HK$ ${p.delivery}</span>
                            </div>
                            <div class="person-detail" style="margin-top:8px;">
                                <span class="detail-label">ğŸ‘‰ æœ€çµ‚å¯¦ä»˜ï¼š</span>
                                <span class="detail-pay">HK$ ${p.finalPay}</span>
                            </div>
                        </div>
                    `;
                    $('#adminPersonResultList').append(personHtml);
                });

                // é¡¯ç¤ºçµæœä¸¦æ»¾å‹•
                $('#adminResultCard').show();
                $('#imgResult').hide();
                $('html, body').animate({scrollTop: $('#adminResultCard').offset().top}, 300);
            });

            // ç”Ÿæˆåˆ†äº«åœ–
            $('#generateImg').click(function() {
                html2canvas(document.getElementById('adminResultCard'), {
                    scale: 2,
                    useCORS: true,
                    backgroundColor: '#faf7f4'
                }).then(canvas => {
                    const imgUrl = canvas.toDataURL('image/png');
                    $('#shareImg').attr('src', imgUrl);
                    $('#imgResult').show();
                    $('html, body').animate({scrollTop: $('#imgResult').offset().top}, 300);
                });
            });

            // ====================== è‡ªå·±å€‹é¤é‚è¼¯ ======================
            $('#userCalc').click(function() {
                const myPrice = parseFloat($('#userMyPrice').val());
                const totalFoodPrice = parseFloat($('#userTotalFood').val()); 
                const totalPeople = parseInt($('#userTotalPeople').val());
                const coupon = parseFloat($('#userCoupon').val()) || 0;
                const discount = parseFloat($('#userDiscount').val()) || 0;
                const delivery = parseFloat($('#userDelivery').val()) || 0;

                // æ ¡é©—å¿…å¡«é …
                if (isNaN(myPrice) || myPrice < 0 || isNaN(totalFoodPrice) || totalFoodPrice < 0 || isNaN(totalPeople) || totalPeople < 1) {
                    alert('è«‹å¡«å¯«æ­£ç¢ºçš„é‡‘é¡ã€æ•´å–®ç¸½åŸåƒ¹å’Œäººæ•¸ï¼');
                    return;
                }
                if (myPrice > totalFoodPrice) {
                    alert('ä½ çš„é¤åƒ¹ä¸èƒ½å¤§æ–¼æ•´å–®ç¸½åŸåƒ¹ï¼');
                    return;
                }

                // å«é¤äººé‚è¼¯ï¼šæŒ‰äººå‡åŸåƒ¹æ¯”ä¾‹åˆ†æ”¤å„ªæƒ ï¼ˆé»˜èªå¤§å®¶é¤åƒ¹æ¥è¿‘ï¼ŒæŒ‰äººå‡è¨ˆæ¯”ä¾‹ï¼‰
                const perPersonOriginal = myPrice; // è‡ªå·±å˜…åŸåƒ¹å³åƒè€ƒäººå‡
                const totalOriginal = perPersonOriginal * totalPeople; // ä¼°ç®—æ•´å–®åŸåƒ¹

                // è¨ˆç®—å„é …æŠµæ‰£
                const ratio = myPrice / totalFoodPrice; // çœŸå¯¦åˆ†æ”¤æ¯”ä¾‹
                const totalDiscountAmt = totalFoodPrice * (discount / 100);
                // const myDiscount = ratio * (totalOriginal * (discount / 100));
                const myDiscount = ratio * totalDiscountAmt;
                const myCoupon = Math.min(ratio * coupon, myPrice - myDiscount);
                const myFoodReal = Math.max(myPrice - myDiscount - myCoupon, 0);
                const myDelivery = delivery / totalPeople;
                const myFinalPay = myFoodReal + myDelivery;

                // æ¸²æŸ“çµæœ
                $('#userMyOriginal').text(`HK$ ${myPrice.toFixed(2)}`);
                $('#userMyDiscount').text(`HK$ ${myDiscount.toFixed(2)}`);
                $('#userMyCoupon').text(`HK$ ${myCoupon.toFixed(2)}`);
                $('#userMyDelivery').text(`HK$ ${myDelivery.toFixed(2)}`);
                $('#userMyFinalPay').text(`HK$ ${myFinalPay.toFixed(2)}`);

                // é¡¯ç¤ºçµæœä¸¦æ»¾å‹•
                $('#userResultCard').show();
                $('html, body').animate({scrollTop: $('#userResultCard').offset().top}, 300);
            });

            // åˆå§‹åŒ–éš±è—çµæœ
            $('#adminResultCard, #userResultCard, #imgResult').hide();
        });
    </script>
</body>
</html>